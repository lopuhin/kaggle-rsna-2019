This is copied from https://github.com/pytorch/xla
